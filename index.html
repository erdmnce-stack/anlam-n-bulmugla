<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Demo YarÄ±ÅŸma (20 Soru)</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-image: url('AdsÄ±z tasarÄ±m (1).png'); /* Resminizin tam adÄ± */
    background-size: cover;
    background-position: center;
    background-attachment: fixed; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .container { max-width: 750px; margin-top: 40px; }
        .card { border: none; shadow: 0 8px 20px rgba(0,0,0,0.1); border-radius: 20px; overflow: hidden; }
        .hidden { display: none !important; }
        .timer-box { font-size: 1.4rem; font-weight: bold; color: #fff; background: #dc3545; padding: 5px 15px; border-radius: 10px; }
        .option-btn { width: 100%; text-align: left; margin-bottom: 12px; padding: 15px; border: 2px solid #e9ecef; border-radius: 12px; transition: all 0.2s; background: #fff; color: #333; }
        .option-btn:hover { background-color: #f8f9fa; border-color: #0d6efd; color: #0d6efd; transform: translateY(-2px); }
        .option-btn:active { background-color: #0d6efd; color: white; }
        .header-bg { background: linear-gradient(135deg, #8B0000 0%, #A0522D 100%); color: white; padding: 40px 20px; text-align: center; }
        #admin-panel { margin-top: 50px; border-top: 2px dashed #ccc; padding-top: 20px; margin-bottom: 50px;}
    </style>
</head>
<body>

<div class="container mb-5">
    
    <div id="login-screen" class="card">
        <div class="header-bg">
            <h1>MuÄŸla Ä°l Milli EÄŸitim MÃ¼dÃ¼rlÃ¼ÄŸÃ¼</h1>
            <p class="mb-0 opacity-75">Dilimizin Zenginlikleri Projesi - AnlamÄ±nÄ± Bul YarÄ±ÅŸmasÄ±</p>
        </div>
        <div class="p-5">
            <form id="user-form">
                <div class="mb-3">
                    <label class="form-label text-muted">AdÄ±nÄ±z SoyadÄ±nÄ±z</label>
                    <input type="text" id="username" class="form-control form-control-lg" required>
                </div>
                <div class="mb-3">
                    <label class="form-label text-muted">Okulunuzun AdÄ±</label>
                    <input type="text" id="useremail" class="form-control form-control-lg" required>
                </div>
                <div class="mb-3">
                    <label class="form-label text-muted">Ä°lÃ§e AdÄ±</label>
                    <input type="text" id="userphone" class="form-control form-control-lg" required>
                </div>
                
                <div class="mb-3">
                    <label class="form-label text-muted">T.C. Kimlik NumarasÄ± (11 Hane)</label>
                    <input type="text" id="user-tckn" class="form-control form-control-lg" 
                           maxlength="11" pattern="[0-9]{11}" 
                           title="T.C. Kimlik NumarasÄ± 11 rakamdan oluÅŸmalÄ±dÄ±r." required>
                </div>
                <button type="submit" class="btn btn-primary btn-lg w-100 py-3 fw-bold mt-2">YarÄ±ÅŸmaya BaÅŸla</button>
            </form>
        </div>
    </div>

    <div id="quiz-screen" class="card p-4 hidden">
        <div class="d-flex justify-content-between align-items-center mb-4 border-bottom pb-3">
            <h5 class="m-0 text-primary" id="question-counter">Soru 1 / 20</h5>
            <div class="timer-box" id="timer">00:00</div>
        </div>
        
        <h4 id="question-text" class="mb-4 lh-base fw-bold">Soru metni yÃ¼kleniyor...</h4>
        
        <div id="options-container">
            </div>
    </div>

    <div id="result-screen" class="card p-5 text-center hidden">
        <div class="mb-4">
            <img src="https://cdn-icons-png.flaticon.com/512/190/190411.png" width="80" alt="Trophy">
        </div>
        <h2 class="fw-bold mb-3">YarÄ±ÅŸma TamamlandÄ±!</h2>
        
        <div class="row justify-content-center mb-4">
            <div class="col-6">
                <div class="bg-light p-3 rounded">
                    <div class="text-muted small">TOPLAM PUAN</div>
                    <div class="display-6 fw-bold text-success" id="final-score">0</div>
                </div>
            </div>
            <div class="col-6">
                <div class="bg-light p-3 rounded">
                    <div class="text-muted small">TOPLAM SÃœRE</div>
                    <div class="display-6 fw-bold text-dark" id="final-time">0:00</div>
                </div>
            </div>
        </div>

        <h5 class="text-start border-bottom pb-2 mt-4">ğŸ† Liderlik Tablosu (Ä°lk 10)</h5>
        <div class="table-responsive">
            <table class="table table-hover text-start align-middle">
                <thead class="table-light">
                    <tr><th>#</th><th>Ä°sim</th><th>Puan</th><th>SÃ¼re</th></tr>
                </thead>
                <tbody id="leaderboard-body">
                    <tr><td colspan="4" class="text-center">YÃ¼kleniyor...</td></tr>
                </tbody>
            </table>
        </div>
        <p class="text-muted small mt-3">SonuÃ§larÄ±nÄ±z sisteme kaydedilmiÅŸtir. Pencereyi kapatabilirsiniz.</p>
    </div>

    <div class="text-center mt-4">
        <button class="btn btn-link text-decoration-none text-muted" onclick="toggleAdmin()">YÃ¶netici GiriÅŸi ğŸ”’</button>
    </div>

    <div id="admin-panel" class="hidden container bg-white p-4 rounded shadow-sm">
        <h3>YÃ¶netici Paneli</h3>
        <div class="input-group mb-3 w-50">
            <input type="password" id="admin-pass" class="form-control" placeholder="Admin Åifresi">
            <button onclick="checkAdmin()" class="btn btn-dark">GiriÅŸ Yap</button>
        </div>
        
        <div id="admin-data" class="hidden">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5>TÃ¼m KatÄ±lÄ±mcÄ± Listesi</h5>
                <button onclick="exportTableToCSV('yarisma-sonuclari.csv')" class="btn btn-success btn-sm">Excel Ä°ndir (CSV)</button>
            </div>
            <div class="table-responsive" style="max-height: 400px; overflow: auto;">
                <table class="table table-bordered table-striped text-small" id="full-table">
                    <thead><tr><th>Tarih</th><th>Ä°sim</th><th>Okul</th><th>Ä°lÃ§e</th><th>TCKN</th><th>Puan</th><th>SÃ¼re(sn)</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script type="module">
    // --- GÃœVENLÄ°K BAÅLANGIÃ‡ (SaÄŸ TÄ±k ve KÄ±sayol Engelleme) ---
  document.addEventListener('contextmenu', event => event.preventDefault());

  document.onkeydown = function(e) {
      if(e.keyCode == 123) { return false; } // F12
      if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) { return false; } // Ctrl+Shift+I
      if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) { return false; } // Ctrl+Shift+C
      if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) { return false; } // Ctrl+U
  }
  // --- GÃœVENLÄ°K BÄ°TÄ°Å ---
  // ==========================================
  // 1. FIREBASE AYARLARI (KENDÄ° BÄ°LGÄ°LERÄ°NÄ° GÄ°R)
  // ==========================================
  // WHERE FONKSÄ°YONU Ä°Ã‡Ä°N Ä°MPORT GÃœNCELLENDÄ°
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, query, orderBy, limit, where } from "https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js";

  const firebaseConfig = {
  apiKey: "AIzaSyARDPDRIO6YUO2NogwOfiCzILmupppbzI4",
  authDomain: "anlamini-bul-mugla.firebaseapp.com",
  projectId: "anlamini-bul-mugla",
  storageBucket: "anlamini-bul-mugla.firebasestorage.app",
  messagingSenderId: "71609064976",
  appId: "1:71609064976:web:f6492705fbe91e09c97495"
};

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ==========================================
  // 2. 20 ADET Ã–RNEK SORU HAVUZU
  // ==========================================
  // 
  const allQuestions = [
    [
  { q: "'Yazar, konuÅŸmasÄ±na kÄ±sa bir anekdot anlatarak baÅŸladÄ±.' cÃ¼mlesindeki anekdot kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["hikÃ¢yecik", "araÃ§", "nesne", "durum"] },

  { q: "'Oyunun son sahnesi o kadar absÃ¼rttÃ¼ ki salon kahkahaya boÄŸuldu.' cÃ¼mlesindeki absÃ¼rt kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["saÃ§ma", "araÃ§", "nesne", "durum"] },

  { q: "'Bu roman diziye adapte edilerek geniÅŸ kitlelere ulaÅŸtÄ±rÄ±ldÄ±.' cÃ¼mlesindeki adapte kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["uyarlanmÄ±ÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'YemeÄŸin sonunda garsondan adisyonu getirmesini istedik.' cÃ¼mlesindeki adisyon kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["hesap", "araÃ§", "nesne", "durum"] },

  { q: "'Kitapta yer alan aforizmalar Ã¶ÄŸrencilerin Ã§ok hoÅŸuna gitti.' cÃ¼mlesindeki aforizma kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶zdeyiÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'MaÃ§ boyunca gÃ¶sterdiÄŸi agresif tavÄ±rlar herkesi rahatsÄ±z etti.' cÃ¼mlesindeki agresif kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["saldÄ±rgan", "araÃ§", "nesne", "durum"] },

  { q: "'Yeni yÄ±lda hedeflerimi ajandama tek tek not ettim.' cÃ¼mlesindeki ajanda kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["andaÃ§", "araÃ§", "nesne", "durum"] },

  { q: "'GÃ¶steride yapÄ±lan akrobasi hareketleri izleyenleri bÃ¼yÃ¼ledi.' cÃ¼mlesindeki akrobasi kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["cambazlÄ±k", "araÃ§", "nesne", "durum"] },

  { q: "'KonuÅŸmasÄ±nda yaptÄ±ÄŸÄ± ajitasyon kalabalÄ±ÄŸÄ± olumsuz etkiledi.' cÃ¼mlesindeki ajitasyon kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kÄ±ÅŸkÄ±rtma", "araÃ§", "nesne", "durum"] },

  { q: "'Onu tanÄ±dÄ±kÃ§a sebepsiz bir antipati hissetmeye baÅŸladÄ±m.' cÃ¼mlesindeki antipati kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sevimsizlik, iticilik", "araÃ§", "nesne", "durum"] },

  { q: "'Åiir antolojisi, farklÄ± ÅŸairlerden seÃ§me eserler iÃ§eriyor.' cÃ¼mlesindeki antoloji kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["seÃ§ki", "araÃ§", "nesne", "durum"] },

  { q: "'FÄ±rÄ±ndan gelen vanilya aromasÄ± bÃ¼tÃ¼n evi sardÄ±.' cÃ¼mlesindeki aroma kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["hoÅŸ koku", "araÃ§", "nesne", "durum"] },

  { q: "'KÃ¼Ã§Ã¼k yaÅŸlardan beri astronomi ile ilgileniyor.' cÃ¼mlesindeki astronomi kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["gÃ¶k bilimi", "araÃ§", "nesne", "durum"] },

  { q: "'Anavgart sanatÃ§Ä±lar genellikle geleneksel anlayÄ±ÅŸÄ±n dÄ±ÅŸÄ±na Ã§Ä±kar.' cÃ¼mlesindeki anavgart kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶ncÃ¼", "araÃ§", "nesne", "durum"] },

  { q: "'Bu Ã§alÄ±ÅŸmada Ã¶nceki yÄ±lÄ±n verilerini baz almak daha doÄŸru olur.' cÃ¼mlesindeki baz almak kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["temel almak", "araÃ§", "nesne", "durum"] },

  { q: "'Konserdeki bateri solosu uzun sÃ¼re alkÄ±ÅŸlandÄ±.' cÃ¼mlesindeki bateri kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["davul", "araÃ§", "nesne", "durum"] },

  { q: "'Roman, dÃ¶nemin burjuva yaÅŸam tarzÄ±nÄ± eleÅŸtirel bir dille anlatÄ±yor.' cÃ¼mlesindeki burjuva kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kent soylu", "araÃ§", "nesne", "durum"] },

  { q: "'Toplumdaki deÄŸerlerin yavaÅŸ yavaÅŸ dejenere olduÄŸunu savunuyor.' cÃ¼mlesindeki dejenere kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["yoz, bozulmuÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'AlbÃ¼mden Ã¶nce kÄ±sa bir demo yayÄ±mlayÄ±p dinleyicilerin tepkisini Ã¶lÃ§tÃ¼ler.' cÃ¼mlesindeki demo kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["tanÄ±tÄ±m gÃ¶sterisi", "araÃ§", "nesne", "durum"] },

  { q: "'PeÅŸ peÅŸe gelen hatalar oyuncuyu tamamen demoralize etti.' cÃ¼mlesindeki demoralize kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["morali bozulmuÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'Raporu hazÄ±rlarken kÃ¼Ã§Ã¼k detaylara bile dikkat etmelisin.' cÃ¼mlesindeki detay kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["ayrÄ±ntÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'ToplantÄ± iÃ§in gerekli tÃ¼m dokÃ¼manlarÄ± klasÃ¶re yerleÅŸtirdim.' cÃ¼mlesindeki dokÃ¼man kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["belge", "araÃ§", "nesne", "durum"] },

  { q: "'YabancÄ± filmler dublaj yerine altyazÄ±lÄ± izlendiÄŸinde dili daha iyi Ã¶ÄŸrenirsin.' cÃ¼mlesindeki dublaj kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["seslendirme", "araÃ§", "nesne", "durum"] },

  { q: "'SÃ¼rekli empoze edilen fikirler Ã¶ÄŸrencilerin zihnini daraltÄ±yor.' cÃ¼mlesindeki empoze kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["dayatÄ±lmÄ±ÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'EndÃ¼stri devrimiyle birlikte Ã¼retim biÃ§imleri tamamen deÄŸiÅŸti.' cÃ¼mlesindeki endÃ¼stri kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sanayi", "araÃ§", "nesne", "durum"] },

  { q: "'EnstrÃ¼man Ã§almak beynin farklÄ± bÃ¶lgelerini aynÄ± anda Ã§alÄ±ÅŸtÄ±rÄ±r.' cÃ¼mlesindeki enstrÃ¼man kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§algÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'YarÄ±ÅŸÄ±n ilk etabÄ± daÄŸlÄ±k bÃ¶lgede koÅŸulacak.' cÃ¼mlesindeki etap kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["aÅŸama", "araÃ§", "nesne", "durum"] },

  { q: "'TÃ¼rkiye'de euro ile alÄ±ÅŸveriÅŸ yapÄ±lan birÃ§ok maÄŸaza bulunuyor.' cÃ¼mlesindeki euro kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["avro", "araÃ§", "nesne", "durum"] },

  { q: "'DÃ¼zenli fitness yapmak hem bedeni hem zihni gÃ¼Ã§lendirir.' cÃ¼mlesindeki fitness kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["saÄŸlÄ±klÄ± yaÅŸam", "araÃ§", "nesne", "durum"] },

  { q: "'Folklor Ã§alÄ±ÅŸmalarÄ±, bir milletin kÃ¼ltÃ¼rel mirasÄ±nÄ± ortaya Ã§Ä±karÄ±r.' cÃ¼mlesindeki folklor kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["halk bilimi", "araÃ§", "nesne", "durum"] },

  { q: "'Bu Ã¼rÃ¼n beÅŸ yÄ±l garanti kapsamÄ±ndadÄ±r.' cÃ¼mlesindeki garanti kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["gÃ¼vence", "araÃ§", "nesne", "durum"] },

  { q: "'Global sorunlara yerel Ã§Ã¶zÃ¼mler Ã¼retmek giderek Ã¶nem kazanÄ±yor.' cÃ¼mlesindeki global kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kÃ¼resel", "araÃ§", "nesne", "durum"] },

  { q: "'YazÄ±m yanlÄ±ÅŸlarÄ±nÄ±n Ã§oÄŸu gramer kurallarÄ±na dikkat edilmemesinden kaynaklanÄ±yor.' cÃ¼mlesindeki gramer kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["dil bilgisi", "araÃ§", "nesne", "durum"] },

  { q: "'SakatlÄ±k onun iÃ§in bÃ¼yÃ¼k bir handikap oluÅŸturdu.' cÃ¼mlesindeki handikap kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["engel", "araÃ§", "nesne", "durum"] },

  { q: "'Kafede Ã¶ÄŸrencilere Ã¶zel happy hour uygulamasÄ± baÅŸlatÄ±ldÄ±.' cÃ¼mlesindeki happy hour kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["indirim saati", "araÃ§", "nesne", "durum"] },

  { q: "'Oyuncu aynÄ± maÃ§ta Ã¼Ã§ gol atarak hat trick yaptÄ±.' cÃ¼mlesindeki hat trick kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¼Ã§leme", "araÃ§", "nesne", "durum"] },

  { q: "'Hacker, sisteme izinsiz girerek birÃ§ok bilgiyi ele geÃ§irdi.' cÃ¼mlesindeki hacker kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["bilgisayar korsanÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'SÄ±cak havada buz gibi ice tea iÃ§mek Ã§ok ferahlatÄ±cÄ± oluyor.' cÃ¼mlesindeki ice tea kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["buzlu Ã§ay", "araÃ§", "nesne", "durum"] },

  { q: "'Bu hipotez deneylerle desteklenirse yeni bir teoriye dÃ¶nÃ¼ÅŸebilir.' cÃ¼mlesindeki hipotez kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["varsayÄ±m", "araÃ§", "nesne", "durum"] },

  { q: "'Denizde jet ski ile dolaÅŸmak adrenalin dolu bir deneyimdir.' cÃ¼mlesindeki jet ski kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["su kÄ±zaÄŸÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'YarÄ±ÅŸmanÄ±n kazananlarÄ±nÄ± jÃ¼ri oy birliÄŸiyle belirledi.' cÃ¼mlesindeki jÃ¼ri kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["seÃ§ici kurul", "araÃ§", "nesne", "durum"] },

  { q: "'Kalifiye eleman bulmak bazÄ± sektÃ¶rlerde oldukÃ§a zorlaÅŸtÄ±.' cÃ¼mlesindeki kalifiye kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["nitelikli", "araÃ§", "nesne", "durum"] },

  { q: "'Depremden sonra ÅŸehirde tam bir kaos ortamÄ± oluÅŸtu.' cÃ¼mlesindeki kaos kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kargaÅŸa", "araÃ§", "nesne", "durum"] },

  { q: "'Montunun kapÃ¼ÅŸon kÄ±smÄ± yaÄŸmurlu havalarda Ã§ok iÅŸine yarÄ±yor.' cÃ¼mlesindeki kapÃ¼ÅŸon kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["baÅŸlÄ±k", "araÃ§", "nesne", "durum"] },

  { q: "'Onun duruÅŸunda insanlarÄ± etkileyen bir karizma var.' cÃ¼mlesindeki karizma kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["etkileyicilik", "araÃ§", "nesne", "durum"] },

  { q: "'Bilim insanlarÄ±, klon hayvanlar Ã¼zerinde Ã§eÅŸitli deneyler yapÄ±yor.' cÃ¼mlesindeki klon kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kopya", "araÃ§", "nesne", "durum"] },

  { q: "'Ã‡alÄ±ÅŸanlarÄ±n Ã§ocuklarÄ± iÃ§in kurum iÃ§inde bir kreÅŸ aÃ§Ä±ldÄ±.' cÃ¼mlesindeki kreÅŸ kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§ocuk yuvasÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Bu iÅŸlem yasal olduÄŸu iÃ§in herhangi bir sorun yaÅŸamazsÄ±nÄ±z.' cÃ¼mlesindeki legal kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["yasal", "araÃ§", "nesne", "durum"] },

  { q: "'Yeni Ã¼rÃ¼nÃ¼n lansmanÄ± bÃ¼yÃ¼k bir salon toplantÄ±sÄ±yla yapÄ±ldÄ±.' cÃ¼mlesindeki lansman kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["tanÄ±tÄ±m", "araÃ§", "nesne", "durum"] },

  { q: "'Bu ilacÄ±n likit formu Ã§ocuklar iÃ§in daha kullanÄ±ÅŸlÄ±.' cÃ¼mlesindeki likit kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sÄ±vÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Ã–dev dosyasÄ±nÄ±n linkini sÄ±nÄ±f grubunda paylaÅŸtÄ±m.' cÃ¼mlesindeki link kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["baÄŸlantÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Onun fikirleri Ã§oÄŸu insana gÃ¶re oldukÃ§a marjinal kalÄ±yor.' cÃ¼mlesindeki marjinal kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["aykÄ±rÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'GÃ¶nderdiÄŸin mesaj bana biraz geÃ§ ulaÅŸtÄ±.' cÃ¼mlesindeki mesaj kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["ileti", "araÃ§", "nesne", "durum"] },

  { q: "'Hamuru karÄ±ÅŸtÄ±rmak iÃ§in mikser kullanmayÄ± tercih etti.' cÃ¼mlesindeki mikser kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§Ä±rpÄ±cÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Bu roman mistik Ã¶gelerle dolu bir dÃ¼nyada geÃ§iyor.' cÃ¼mlesindeki mistik kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["gizemci", "araÃ§", "nesne", "durum"] },

  { q: "'Hayatta kendine seÃ§tiÄŸi motto, her zaman dÃ¼rÃ¼st olmaktÄ±.' cÃ¼mlesindeki motto kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶zdeyiÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'Filmin montaj aÅŸamasÄ± beklenenden uzun sÃ¼rdÃ¼.' cÃ¼mlesindeki montaj kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kurgu", "araÃ§", "nesne", "durum"] },

  { q: "'Narsist kiÅŸiler genellikle kendilerini baÅŸkalarÄ±ndan Ã¼stÃ¼n gÃ¶rÃ¼r.' cÃ¼mlesindeki narsist kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶zsever", "araÃ§", "nesne", "durum"] },

  { q: "'OtobÃ¼sler ÅŸehirler arasÄ± hatta non stop seferler dÃ¼zenliyor.' cÃ¼mlesindeki non stop kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["duraksÄ±z", "araÃ§", "nesne", "durum"] },

  { q: "'Ä°nternet baÄŸlantÄ±sÄ± kesilince sistem off line konuma geÃ§ti.' cÃ¼mlesindeki off line kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§evrim dÄ±ÅŸÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Bu tasarÄ±m tamamen orijinal, kimseye benzemiyor.' cÃ¼mlesindeki orijinal kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶zgÃ¼n", "araÃ§", "nesne", "durum"] },

  { q: "'Åehrin yeni plaza bÃ¶lgesinde Ã§ok sayÄ±da ofis bulunuyor.' cÃ¼mlesindeki plaza kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["iÅŸ merkezi", "araÃ§", "nesne", "durum"] },

  { q: "'Ä°ki yazar arasÄ±nda gazetede sert bir polemik baÅŸladÄ±.' cÃ¼mlesindeki polemik kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sÃ¶z dalaÅŸÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'HayatÄ±nda bazÄ± prensiplerden asla vazgeÃ§miyor.' cÃ¼mlesindeki prensip kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["ilke", "araÃ§", "nesne", "durum"] },

  { q: "'BoÅŸ zamanlarÄ±nda puzzle yaparak dinlenmeyi seviyor.' cÃ¼mlesindeki puzzle kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["yapboz", "araÃ§", "nesne", "durum"] },

  { q: "'DÃ¼zenli bakÄ±m yapÄ±lmayan makinelerden yeterli randÄ±man alÄ±namaz.' cÃ¼mlesindeki randÄ±man kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["verim", "araÃ§", "nesne", "durum"] },

  { q: "'UÃ§aÄŸÄ±n kalkÄ±ÅŸÄ± yoÄŸun sis nedeniyle rÃ¶tar yaptÄ±.' cÃ¼mlesindeki rÃ¶tar kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["gecikme", "araÃ§", "nesne", "durum"] },

  { q: "'SÄ±navdan Ã¶nceki geceyi sabote eden gÃ¼rÃ¼ltÃ¼lÃ¼ bir inÅŸaat vardÄ±.' cÃ¼mlesindeki sabote kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["baltalama", "araÃ§", "nesne", "durum"] },

  { q: "'Yeni Ã¶ÄŸretmen Ã¶ÄŸrencilere karÅŸÄ± Ã§ok sempatik davranÄ±yor.' cÃ¼mlesindeki sempatik kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sÄ±cakkanlÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'MaÃ§Ä±n skor tabelasÄ± sÄ±k sÄ±k bozuldu.' cÃ¼mlesindeki skor kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sonuÃ§", "araÃ§", "nesne", "durum"] },

  { q: "'Bu metin bana biraz fazla sofistike geldi.' cÃ¼mlesindeki sofistike kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["yapmacÄ±k, yanÄ±ltÄ±cÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Bu iddia tamamen spekÃ¼latif yorumlara dayanÄ±yor.' cÃ¼mlesindeki spekÃ¼latif kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kurgusal, saptÄ±rÄ±cÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'ArkadaÅŸlarÄ±yla buluÅŸma kararÄ± tamamen spontane geliÅŸti.' cÃ¼mlesindeki spontane kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kendiliÄŸinden", "araÃ§", "nesne", "durum"] },

  { q: "'Åef, bu akÅŸama Ã¶zel bir spesiyal hazÄ±rladÄ±ÄŸÄ±nÄ± sÃ¶yledi.' cÃ¼mlesindeki spesiyal kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶zel", "araÃ§", "nesne", "durum"] },

  { q: "'Depoda biriken stok miktarÄ± beklenenden fazla Ã§Ä±ktÄ±.' cÃ¼mlesindeki stok kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["yÄ±ÄŸÄ±lÄ±m", "araÃ§", "nesne", "durum"] },

  { q: "'Defterinin kapaÄŸÄ±na renkli stickerlar yapÄ±ÅŸtÄ±rmÄ±ÅŸ.' cÃ¼mlesindeki sticker kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§Ä±kartma", "araÃ§", "nesne", "durum"] },

  { q: "'Hatalara karÅŸÄ± belli bir tolerans gÃ¶sterilmelidir.' cÃ¼mlesindeki tolerans kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["hoÅŸgÃ¶rÃ¼", "araÃ§", "nesne", "durum"] },

  { q: "'YaÅŸadÄ±ÄŸÄ± trafik kazasÄ± onda derin bir travma bÄ±raktÄ±.' cÃ¼mlesindeki travma kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["sarsÄ±ntÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Bu yÄ±l sade tasarÄ±mlar moda trendleri arasÄ±nda Ã¶ne Ã§Ä±kÄ±yor.' cÃ¼mlesindeki trend kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["eÄŸilim", "araÃ§", "nesne", "durum"] },

  { q: "'Kurulan ÅŸehir tamamen Ã¼topik bir dÃ¼zen Ã¼zerine kurgulanmÄ±ÅŸ.' cÃ¼mlesindeki Ã¼topik kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["hayalÃ®", "araÃ§", "nesne", "durum"] },

  { q: "'Ä°nternetin temelini oluÅŸturan web teknolojileri hÄ±zla geliÅŸiyor.' cÃ¼mlesindeki web kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["aÄŸ", "araÃ§", "nesne", "durum"] },

  { q: "'Bu hafta sÄ±nÄ±f iÃ§in yaratÄ±cÄ± drama workshop Ã§alÄ±ÅŸmasÄ± yapÄ±lacak.' cÃ¼mlesindeki workshop kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§alÄ±ÅŸtay", "araÃ§", "nesne", "durum"] },
{ q: "'Bu makalenin analizi oldukÃ§a kapsamlÄ± bir Ã§alÄ±ÅŸma gerektiriyor.' cÃ¼mlesindeki analiz kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã§Ã¶zÃ¼mleme", "araÃ§", "nesne", "durum"] },

  { q: "'Projeye baÅŸlamadan Ã¶nce bir konsept belirlememiz gerekiyor.' cÃ¼mlesindeki konsept kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kavram", "araÃ§", "nesne", "durum"] },

  { q: "'Bu sÃ¼reÃ§te mentor desteÄŸi almak Ã§ok faydalÄ± olabilir.' cÃ¼mlesindeki mentor kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["rehber", "araÃ§", "nesne", "durum"] },

  { q: "'Yeni kurulan start-up kÄ±sa sÃ¼rede yatÄ±rÄ±mcÄ±larÄ±n dikkatini Ã§ekti.' cÃ¼mlesindeki start-up kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["giriÅŸim", "araÃ§", "nesne", "durum"] },

  { q: "'Bu tabloda tÃ¼m modÃ¼l ayarlarÄ±nÄ± gÃ¶rebilirsiniz.' cÃ¼mlesindeki modÃ¼l kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["bÃ¶lÃ¼m", "araÃ§", "nesne", "durum"] },

  { q: "'SanatÃ§Ä±nÄ±n portfolyo sunumu izleyenleri etkiledi.' cÃ¼mlesindeki portfolyo kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["eser dosyasÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Yeni medya kampanyasÄ± oldukÃ§a etkili bir sloganla hazÄ±rlandÄ±.' cÃ¼mlesindeki slogan kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["Ã¶zdeyiÅŸ", "araÃ§", "nesne", "durum"] },

  { q: "'Her departmanÄ±n kendi stratejisini oluÅŸturmasÄ± bekleniyor.' cÃ¼mlesindeki strateji kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["yÃ¶ntem", "araÃ§", "nesne", "durum"] },

  { q: "'TakÄ±m iÃ§inde yapÄ±lan brief toplantÄ±sÄ± oldukÃ§a verimli geÃ§ti.' cÃ¼mlesindeki brief kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kÄ±sa bilgilendirme", "araÃ§", "nesne", "durum"] },

  { q: "'ÃœrÃ¼n tasarÄ±mÄ± sÄ±rasÄ±nda prototip Ã¼zerinde birÃ§ok deÄŸiÅŸiklik yapÄ±ldÄ±.' cÃ¼mlesindeki prototip kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["ilk Ã¶rnek", "araÃ§", "nesne", "durum"] },

  { q: "'Bu iÅŸ iÃ§in uygun bir profil bulmak biraz zaman alacak.' cÃ¼mlesindeki profil kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["kiÅŸisel Ã¶zellik", "araÃ§", "nesne", "durum"] },

  { q: "'Bu sistemin optimum dÃ¼zeyde Ã§alÄ±ÅŸmasÄ± iÃ§in ayar yapÄ±lmasÄ± gerekiyor.' cÃ¼mlesindeki optimum kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["en uygun", "araÃ§", "nesne", "durum"] },

  { q: "'YÃ¶netim kurulu projeyi onaylamak iÃ§in bir vizyon sunulmasÄ±nÄ± istedi.' cÃ¼mlesindeki vizyon kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["gelecek tasarÄ±mÄ±", "araÃ§", "nesne", "durum"] },

  { q: "'Ekibin motivasyonunu artÄ±rmak iÃ§in yeni bir misyon belirlendi.' cÃ¼mlesindeki misyon kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["gÃ¶rev", "araÃ§", "nesne", "durum"] },

  { q: "'Bu yapÄ±mÄ±n kadrosunda tanÄ±nmÄ±ÅŸ bir cast bulunuyor.' cÃ¼mlesindeki cast kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["oyuncu kadrosu", "araÃ§", "nesne", "durum"] },

  { q: "'Sunumdan Ã¶nce kÃ¼Ã§Ã¼k bir demo hazÄ±rladÄ±k.' cÃ¼mlesindeki demo kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["tanÄ±tÄ±m Ã¶rneÄŸi", "araÃ§", "nesne", "durum"] },

  { q: "'Bu formu doldururken tÃ¼m feedback bÃ¶lÃ¼mÃ¼nÃ¼ eksiksiz tamamlayÄ±n.' cÃ¼mlesindeki feedback kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["geri bildirim", "araÃ§", "nesne", "durum"] },

  { q: "'Etkinlik sonunda katÄ±lÄ±mcÄ±lara sertifika verilecek.' cÃ¼mlesindeki sertifika kelimesinin TÃ¼rkÃ§e karÅŸÄ±lÄ±ÄŸÄ± nedir?", a: ["belge", "araÃ§", "nesne", "durum"] }
]

  ];

  // ==========================================
  // TCKN KONTROL VE TEKRAR GÄ°RÄ°Å ENGELÄ° FONKSÄ°YONU
  // ==========================================
  window.checkTcknAndStart = async (userInfo) => {
    const tckn = userInfo.tckn;

    // 1. 11 Hane KontrolÃ¼
    if (tckn.length !== 11) {
        alert("HATA: T.C. Kimlik NumarasÄ± tam olarak 11 rakamdan oluÅŸmalÄ±dÄ±r.");
        return false;
    }
    
    // 2. Sadece Rakam KontrolÃ¼
    if (!/^\d{11}$/.test(tckn)) {
        alert("HATA: T.C. Kimlik NumarasÄ± sadece rakamlardan oluÅŸmalÄ±dÄ±r.");
        return false;
    }

    // 3. Tekrar GiriÅŸ Engeli (Firebase KontrolÃ¼)
    const q = query(collection(db, "scores"), where("tckn", "==", tckn));
    const snapshot = await getDocs(q);

    if (!snapshot.empty) {
        alert("HATA: Bu T.C. Kimlik NumarasÄ± ile daha Ã¶nce yarÄ±ÅŸmaya katÄ±lÄ±m saÄŸlanmÄ±ÅŸtÄ±r.");
        return false;
    }

    return true; // TÃ¼m kontroller baÅŸarÄ±lÄ±
}


  // ==========================================
  // 3. OYUN MOTORU
  // ==========================================
  let quizQuestions = [];
  let currentQIndex = 0;
  let score = 0;
  let timerInterval;
  let totalSeconds = 0;
  let userInfo = {};

  // Ekran Elementleri
  const els = {
      login: document.getElementById('login-screen'),
      quiz: document.getElementById('quiz-screen'),
      result: document.getElementById('result-screen'),
      counter: document.getElementById('question-counter'),
      qText: document.getElementById('question-text'),
      opts: document.getElementById('options-container'),
      timer: document.getElementById('timer'),
      score: document.getElementById('final-score'),
      time: document.getElementById('final-time')
  };

  // BaÅŸlama Butonu GÃœNCELLENDÄ° (ASYNC YAPILDI)
  document.getElementById('user-form').addEventListener('submit', async (e) => {
      e.preventDefault();
      userInfo = {
          name: document.getElementById('username').value,
          email: document.getElementById('useremail').value,
          phone: document.getElementById('userphone').value,
          tckn: document.getElementById('user-tckn').value // Yeni alan eklendi
      };
      
      const isTcknValid = await checkTcknAndStart(userInfo);
    
      if (isTcknValid) {
          startQuiz();
      }
  });

  function startQuiz() {
      els.login.classList.add('hidden');
      els.quiz.classList.remove('hidden');

      // 50 soruluk havuzu rastgele karÄ±ÅŸtÄ±r ve ilk 20 tanesini seÃ§.
      // Bu, yarÄ±ÅŸmada her seferinde farklÄ± bir 20 soru seti kullanÄ±lmasÄ±nÄ± saÄŸlar.
      quizQuestions = [...allQuestions]
          .sort(() => 0.5 - Math.random()) // TÃ¼m havuzu karÄ±ÅŸtÄ±r
          .slice(0, 20); // Ä°lk 20 soruyu seÃ§
      
      // ZamanlayÄ±cÄ±yÄ± baÅŸlat
      timerInterval = setInterval(() => {
          totalSeconds++;
          const m = Math.floor(totalSeconds / 60).toString().padStart(2, '0');
          const s = (totalSeconds % 60).toString().padStart(2, '0');
          els.timer.innerText = `${m}:${s}`;
      }, 1000);

      loadQuestion();
  }

  function loadQuestion() {
      if (currentQIndex >= quizQuestions.length) {
          endQuiz();
          return;
      }

      const q = quizQuestions[currentQIndex];
      els.counter.innerText = `Soru ${currentQIndex + 1} / ${quizQuestions.length}`;
      els.qText.innerText = q.q;
      els.opts.innerHTML = '';

      // ÅÄ±klarÄ± karÄ±ÅŸtÄ±r (DoÄŸru cevabÄ± takip et)
      let options = q.a.map((txt, i) => ({ text: txt, isCorrect: i === 0 }));
      options.sort(() => 0.5 - Math.random());

      options.forEach(opt => {
          const btn = document.createElement('button');
          btn.className = 'btn option-btn';
          btn.innerHTML = `<span>${opt.text}</span>`;
          btn.onclick = () => handleAnswer(opt.isCorrect);
          els.opts.appendChild(btn);
      });
  }

  function handleAnswer(isCorrect) {
      if (isCorrect) score += 5; // Her doÄŸru 5 puan (20 soru * 5 = 100)
      currentQIndex++;
      loadQuestion();
  }

  async function endQuiz() {
      clearInterval(timerInterval);
      els.quiz.classList.add('hidden');
      els.result.classList.remove('hidden');

      els.score.innerText = score;
      const m = Math.floor(totalSeconds / 60);
      const s = totalSeconds % 60;
      els.time.innerText = `${m}dk ${s}sn`;

      // Firebase KaydÄ± GÃœNCELLENDÄ° (TCKN EKLENDÄ°)
      try {
          await addDoc(collection(db, "scores"), {
              name: userInfo.name,
              email: userInfo.email,
              phone: userInfo.phone,
              tckn: userInfo.tckn, // YENÄ°: TCKN kaydediliyor
              score: score,
              time: totalSeconds,
              date: new Date().toISOString()
          });
          getLeaderboard();
      } catch (err) {
          console.error("KayÄ±t hatasÄ±:", err);
          alert("Puan kaydedilemedi, internet baÄŸlantÄ±nÄ±zÄ± kontrol edin.");
      }
  }

  async function getLeaderboard() {
      const q = query(collection(db, "scores"), orderBy("score", "desc"), orderBy("time", "asc"), limit(10));
      const snapshot = await getDocs(q);
      const tbody = document.getElementById('leaderboard-body');
      tbody.innerHTML = '';
      
      let rank = 1;
      snapshot.forEach(doc => {
          const d = doc.data();
          tbody.innerHTML += `<tr><td>${rank++}</td><td>${d.name}</td><td><strong>${d.score}</strong></td><td>${d.time}sn</td></tr>`;
      });
  }

  // --- GLOBAL ADMIN FONKSÄ°YONLARI ---
  window.toggleAdmin = () => document.getElementById('admin-panel').classList.toggle('hidden');
  
  window.checkAdmin = async () => {
      if(document.getElementById('admin-pass').value === "admin123") {
          document.getElementById('admin-data').classList.remove('hidden');
          const snapshot = await getDocs(query(collection(db, "scores"), orderBy("score", "desc")));
          const tbody = document.querySelector('#full-table tbody');
          tbody.innerHTML = '';
          // ADMIN TABLO Ä°Ã‡ERÄ°ÄÄ° GÃœNCELLENDÄ° (TCKN EKLENDÄ°)
          snapshot.forEach(doc => {
              const d = doc.data();
              tbody.innerHTML += `<tr><td>${new Date(d.date).toLocaleDateString()}</td><td>${d.name}</td><td>${d.email}</td><td>${d.phone}</td><td>${d.tckn || 'N/A'}</td><td>${d.score}</td><td>${d.time}</td></tr>`;
          });
      } else { alert("HatalÄ± Åifre!"); }
  }

  window.exportTableToCSV = (filename) => {
    const rows = document.querySelectorAll("#full-table tr");
    let csv = [];
    for (const row of rows) {
        const cols = row.querySelectorAll("td, th");
        csv.push(Array.from(cols).map(c => c.innerText).join(","));
    }
    const blob = new Blob([csv.join("\n")], {type: "text/csv"});
    const link = document.createElement("a");
    link.href = window.URL.createObjectURL(blob);
    link.download = filename;
    link.click();
  }
</script>

</body>

</html>
